[Phase 1] 
               rule_prompt = """
                **Role**: 보험 약관 분석 전문가 및 검색 전략 수립가.
                
                **Goal**: 
                제공된 참조 문서(약관 및 담보 테이블)를 분석하여, 향후 Phase 2에서 **'담보명'과 '세부담보템플릿명'에 해당하는 약관 내용을 정확히 찾아낼 수 있도록 돕는 검색 단서(Search Clues)와 전략**을 추출하세요.
                
                **Instructions**:
                - 단순히 내용을 요약하지 말고, **"이 담보를 찾으려면 약관에서 어떤 키워드를 봐야 하는가?"**에 집중하세요.
                - '세부담보템플릿명'이 실제 약관 텍스트로는 어떻게 표현되는지 패턴을 분석하세요.
                
                **Output Requirements (다음 항목을 포함하여 최대한 자세히 기술하세요)**:
                1. **핵심 검색 키워드 (Critical Keywords)**: 
                   - 해당 세부담보템플릿을 식별하기 위해 약관에서 반드시 찾아야 할 단어, 문구, 혹은 조항 명칭.
                   - 예: "암진단비(유사암제외)" 템플릿 -> 약관 내 "소액암", "제자리암", "경계성종양" 등의 키워드 확인 필요.
                
                2. **동의어 및 표현 변형 (Synonyms & Aliases)**:
                   - 템플릿명이 약관에서는 다르게 표현되는 경우 (예: "뇌졸중" -> "뇌출혈 및 뇌경색증").
                
                3. **포함/제외 조건 (Inclusion/Exclusion Candidates)**:
                   - 특정 템플릿으로 매핑하기 위한 결정적 조건 (예: "갱신형" 텍스트가 있으면 '갱신형 템플릿' 선택).
                
                4. **위치 단서 (Location Clues)**:
                   - 해당 담보가 주로 등장하는 약관의 섹션이나 맥락 (예: "보통약관 제3조", "특별약관 파트").
                
                이 분석 결과는 Phase 2에서 AI가 타겟 약관을 뒤질 때 **네비게이션 지도** 역할을 할 것입니다.
                """

[Phase 2]
               prompt = f"""
                **Task**: 제공된 '담보명'과 '세부담보템플릿명'을 검토하고, 타겟 약관에서 이를 뒷받침하는 근거를 찾아 매핑을 검증/보완하세요.

                **Input Benefit List (Batch {batch_number}/{total_batches})**:
                {batch_str}
                
                **Mapping Rules (참조 문서에서 추출한 추론 가이드라인 - 참고용)**:
                {mapping_logic_text}
                
                **Instructions**:
                1. 입력된 '담보명'과 '세부담보템플릿명' 쌍을 순서대로 분석하세요.
                2. **input_template_name**: 입력 목록에 있는 '세부담보템플릿명'을 그대로 반환하세요 (매핑 기준 키로 사용됨).
                3. **inferred_template_name (추론된 템플릿명)**:
                   - 타겟 약관에서 '담보명'과 '세부담보템플릿명'의 연관성을 찾으세요.
                   - ** Mapping Rules (참조 문서 가이드라인)**을 적극 활용하여, **가장 적합한(Most Probable)** 템플릿명을 선택하세요.
                   - 100% 일치하지 않더라도, 문맥상 의미가 통하거나 참조 규칙에 부합하면 매핑하세요.
                   - 단, 전혀 관련 없는 경우에는 빈칸("")으로 두세요.
                4. **ref_sentence (근거 문장)**:
                   - 타겟 약관에서 찾은 **문장 원문**을 그대로 기입하세요.
                   - 문장 뒤에 **[선정 이유]**를 간략히 덧붙여주세요. (예: "...함. [이유: 약관 제3조에 해당 담보 명칭이 명시됨]")
                5. 해당 내용이 위치한 **페이지 번호**를 찾으세요.
                
                **Output JSON**:
                [
                  {{
                    "benefit_name": "입력된 담보명",
                    "input_template_name": "입력된 세부담보템플릿명",
                    "inferred_template_name": "추론된 템플릿명", 
                    "ref_page": "페이지번호",
                    "ref_sentence": "문장 원문 [선정 이유]"
                  }}
                ]
                """
                
